# parcel-react-cli

使用  [parcel 2.0](https://v2.parceljs.org/) 打包，其中已包含配置一下依赖：

- react  + react-loadable
- [dva](https://dvajs.com/)
- scss
- [typescript](https://www.tslang.cn/docs/handbook/basic-types.html)
- lodash 库
- eslint



## 📖使用

**安装依赖**

```bash
npm install
```

**运行开发环境**

```bash
npm run start
```

**打包**

```bash
npm run build
```

**代码规范检查**

```bash
npm run lint
```

**jest测试**

```bash
npm run test
```

### 路由配置

在 `src/router/route.config.ts` 配置即可。

```typescript
// 配置格式，例如
{
    name: '首页',
    path: '/',
    exact: true,
    component: Loadable(() => import('../pages/Home'))
}
```



### models导入导出问题

需要 `dva` 注册的 `model` 需要在 `src/models/index.ts`  文件中进行导入导出，记住 `index.ts` 导出必须是数组，即可完成自动注册。



### 错误处理

路由错误会默认跳转到 `404.tsx`，可通过编辑 `404.tsx` 自定义错误页面。



### 代理

在根目录新建 `.proxyrc` 文件，配置如下：

```json
{
  "/api": {
    "target": "http://localhost:8000/",
    "pathRewrite": {
      "^/api": ""
    }
  }
}
```



## ❗注意

parcel 2版本相对于 1版本来说有略微的改动。详情查看 [🔗迁移](https://v2.parceljs.org/getting-started/migration/)

> Many `package.json`s (e.g. the one generated by `npm init`) contains `main: "index.js"` which ignored by most tools (for non-library projects). Parcel 2 will however use that value as the output path
>
> 大概的意思就是 parcel 2 会将 `package.json` 中的 `main ` 作为输出路径。这个是与1版本不同的，比较容易踩坑，请注意一下。



